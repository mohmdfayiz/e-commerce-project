<%- include('../layoutHeader.ejs') -%>
<!-- Layout wrapper -->
<div class="layout-wrapper layout-content-navbar">
  <div class="layout-container">
    <!-- Menu -->
    <%- include("./menu.ejs") -%>
    <!-- / Menu -->

    <!-- Layout container -->
    <div class="layout-page">
      <!-- Navbar -->
      <%- include('./navbar.ejs') -%>
      <!-- / Navbar -->

      <!-- Hoverable Table rows -->

      <form action="/admin/addSubcategory" method="post" class="mx-4 mt-4">
        <div class="input-group"> 
          <select name="parentCategory" class="form-select" id="">
            <option value="">Select a category</option>
            <% categories.forEach(function(x){ %>
              <option value="<%= x.category %>"><%= x.category %></option>
            <% }) %>
          </select>

          <input
            type="text"
            name="category"
            class="form-control"
            placeholder="Type here..."
            required
          />
          <button class="btn btn-success" type="submit" id="button-addon2">
            Add new
          </button>
        </div>
      </form>

      <div class="card mt-2 mx-4">
        <h5 class="card-header">Subcategories.</h5>
        <div class="table-responsive text-nowrap">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Subcategory</th>
                <th>Parent</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody class="table-border-bottom-0">
              <% subcategories.forEach(function(x){ %>
              <tr>
                <td><%= x.category %></td>
                <td><%= x.parentCategory %></td>
                <td>
                  <div class="text-center">
                    <% if(!x.isDeleted){ %>
                    <form action="/admin/deleteSubcategory/<%= x._id %>" method="post">
                      <button type="submit" class="btn dropdown-item" onclick="return confirm('Are you sure?')">Delete</button>
                    </form>
                    <% }else{ %>
                    <form action="/admin/restoreSubcategory/<%= x._id %>" method="post">
                      <button type="submit" class="btn dropdown-item" onclick="return confirm('Are you sure?')">Restore</button>
                    </form>
                    <% } %>
                  </div>
                </td>
              </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
      <!--/ Hoverable Table rows -->

      <div class="content-backdrop fade"></div>
    </div>
    <!-- / Layout page -->
  </div>

  <!-- Overlay -->
  <div class="layout-overlay layout-menu-toggle"></div>
</div>
<!-- / Layout wrapper -->

<%- include('../layoutFooter.ejs') -%>
