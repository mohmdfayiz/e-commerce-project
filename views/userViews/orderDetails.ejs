<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ride.</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="../public/admin/styles/style.css">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../public/admin/img/favicon/favicon.ico" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet" />

    <!-- Icons. Uncomment required icon fonts -->
    <link rel="stylesheet" href="../public/admin/vendor/fonts/boxicons.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="../public/admin/vendor/css/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="../public/admin/vendor/css/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="../public/admin/css/demo.css" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="../public/admin/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />

    <link rel="stylesheet" href="../public/admin/vendor/libs/apex-charts/apex-charts.css" />

    <!-- Page CSS -->
    <!--===============================================================================================-->
    <link rel="icon" type="image/x-icon" href="../public/admin/img/favicon/favicon.ico" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/bootstrap/css/bootstrap.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/fonts/font-awesome-4.7.0/css/font-awesome.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/fonts/iconic/css/material-design-iconic-font.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/fonts/linearicons-v1.0.0/icon-font.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/animate/animate.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/css-hamburgers/hamburgers.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/animsition/css/animsition.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/select2/select2.min.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/daterangepicker/daterangepicker.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/slick/slick.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/MagnificPopup/magnific-popup.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/vendor/perfect-scrollbar/perfect-scrollbar.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/users/css/util.css" />
    <link rel="stylesheet" type="text/css" href="/public/users/css/main.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <!-- =============gooogle icons ============= -->
    <link rel="stylesheet" href="/public/styles/style.css" />

    <!-- ============== Search field style =============-->
    <!-- Helpers -->
    <script src="../public/admin/vendor/js/helpers.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="../public/admin/js/config.js"></script>

    <!-- ajax -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>

    <style>
        html {
            overflow-x: hidden;
        }
    </style>
    <header>
        <!-- Header desktop -->
        <div class="container-menu-desktop">
            <!-- Topbar -->
            <div class="top-bar">
                <div class="content-topbar flex-sb-m h-full container">
                    <div class="left-top-bar">
                        Free shipping for standard order over $5000
                    </div>

                    <div class="right-top-bar flex-w h-full">

                        <form action="/logout" method="post">
                            <button class="flex-c-m trans-04 p-lr-25" type="submit" style="color: grey; margin: 10px">
                                Logout
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="wrap-menu-desktop">
                <nav class="limiter-menu-desktop container">
                    <!-- Logo desktop -->
                    <a href="/" class="logo">
                        <img src="/public/admin/img/favicon/favicon.ico" alt="IMG-LOGO" />
                        <h2 style="color: #566a7f; font-weight: bold">ride.</h2>
                    </a>

                    <!-- Menu desktop -->
                    <div class="menu-desktop">
                        <ul class="main-menu">
                            <li class="active-menu">
                                <a href="/">Home</a>
                            </li>

                            <li>
                                <a href="#">Shop</a>
                            </li>

                            <li>
                                <a href="#">Bikes</a>
                            </li>

                            <li>
                                <a href="#">Accessories</a>
                            </li>
                            <li>
                                <a href="#">Gadgets</a>
                            </li>
                        </ul>
                    </div>

                    <!-- Icon header -->
                    <div class="wrap-icon-header flex-w flex-r-m">
                        <div class="search-box">
                            <input class="search-text" type="text" name="" placeholder="Type to search" />
                            <span
                                class="material-symbols-outlined search-btn icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
                                search
                            </span>
                        </div>

                        <a href="/wishlist" class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 ">
                            <span class="material-symbols-outlined ">
                                favorite
                            </span>
                        </a>

                        <a href="/cart" class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
                            <span class="material-symbols-outlined"> shopping_cart </span>
                        </a>
                        <a href="/account">
                            <span class="material-symbols-outlined icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11"
                                style="font-size: 28px">
                                person
                            </span>
                        </a>

                        <!-- <a
                  href="#"
                  class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti">
                  <i class="zmdi zmdi-favorite-outline"></i>
                </a> -->
                    </div>
                </nav>
            </div>
        </div>

        <!-- Header Mobile -->
        <div class="wrap-header-mobile">
            <!-- Logo moblie -->
            <div class="logo-mobile">
                <a href="/"><img src="/public/admin/img/favicon/favicon.ico" alt="IMG-LOGO" /></a>
            </div>

            <!-- Icon header -->
            <div class="wrap-icon-header flex-w flex-r-m m-r-15">
                <div class="search-box">
                    <input class="search-text" type="text" name="" placeholder="Type to search" />

                    <span
                        class="material-symbols-outlined search-btn icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
                        search
                    </span>
                </div>

                <span class="material-symbols-outlined icon-header-item cl2 hov-cl1 trans-04 p-r-11 js-show-cart">
                    shopping_cart
                </span>

                <span class="material-symbols-outlined icon-header-item cl2 hov-cl1 trans-04 p-r-11"
                    style="font-size: 28px">
                    person
                </span>
            </div>

            <!-- Button show menu -->
            <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </div>
        </div>

        <!-- Menu Mobile -->
        <div class="menu-mobile">
            <ul class="main-menu-m">
                <li>
                    <a href="/">Home</a>
                </li>

                <li>
                    <a href="">Bicycles</a>
                </li>

                <li>
                    <a href="">Accessories</a>
                </li>

                <li>
                    <a href="#">Gadgets</a>
                </li>

                <li>
                    <a href="#">About</a>
                </li>
            </ul>
        </div>
        <!-- Modal Search -->
        <div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
            <div class="container-search-header">
                <button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
                    <img src="images/icons/icon-close2.png" alt="CLOSE" />
                </button>

                <form class="wrap-search-header flex-w p-l-15">
                    <button class="flex-c-m trans-04">
                        <i class="zmdi zmdi-search"></i>
                    </button>
                    <input class="plh3" type="text" name="search" placeholder="Search..." />
                </form>
            </div>
        </div>
    </header>
    <div class="d-none d-lg-block" style="height:100px;"></div>
    <section>
        <div class="container">
            <div class="row"
                style="background-image: linear-gradient(to right,#696cff,#9697f8) ;border-radius: 8px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);">
                <div class="col-8 d-flex align-items-center">
                    <span class="material-symbols-outlined text-light mt-2"> inventory_2</span>
                    <h4 class="ps-1 mt-2 text-light">Order</h4>
                </div>
                <div class="col-4 d-flex align-items-center justify-content-end">
                    <a href="/orders" data-bs-toggle="tooltip" data-bs-offset="0,4" data-bs-placement="top" data-bs-html="true"
                        title="<span>Orders</span>" class="mt-3 p-3 text-light"><span
                            class="material-symbols-outlined text-light">
                            inventory_2
                        </span></a>
                    <a href="/manageAddress" data-bs-toggle="tooltip" data-bs-offset="0,4" data-bs-placement="top"
                        data-bs-html="true" title="<span>Address</span>" class="mt-3 p-3"><span
                            class=" material-symbols-outlined text-light">
                            location_on
                        </span></a>
                    <a href="/changePassword" data-bs-toggle="tooltip" data-bs-offset="0,4" data-bs-placement="top"
                        data-bs-html="true" title="<span>Change Password</span>" class="mt-3 p-3"><span
                            class="material-symbols-outlined text-light">
                            lock_open
                        </span></a>
                </div>
            </div>
        </div>
    </section>

    <section class="container">
        <div class="row">
            <div class="row">
                <div class="col box p-4">
                    <table class="table">
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <th>Total</th>
                        </tr>
                        <% order.products.forEach(function(product){ %>
                            <tr>
                                <td class="d-flex align-items-center p-2">
                                    <img src="/<%=product.productId.imageUrl[0]%>" alt="Img" style="width: 50px;">
                                    <%= product.productId.productName%>
                                </td>
                                <td>
                                    <%= product.quantity %>
                                </td>
                                <td>
                                    <%= product.productId.price %>
                                </td>
                                <td>
                                    <%= product.total %>
                                </td>
                            </tr>
                            <% }) %>
                                <tr>
                                    <td colspan="3" class="text-end"><strong>Grand Total</strong></td>
                                    <td> <strong>â‚¹ <%=order.total%></strong></td>
                                </tr>
                    </table>
                </div>
            </div>
        </div>
        <div class="row my-3 box">
            <div class="col-12 col-md-6 border">
                <h5 class="text-center p-2">Shipping Address</h5>
                <div class="ps-3 pt-3">
                    <p>Full name: <%= order.address.fullName %>
                    </p>
                    <p>Phone no : <%= order.address.phoneNumber %>
                    </p>
                    <p>Address : <%= order.address.address %>, <%= order.address.city %>, <%= order.address.state %> -
                                    <%= order.address.pincode %>
                    </p>
                    <p>Type : <%= order.address.type %>
                    </p>
                </div>
            </div>
            <div class="col-12 col-md-6 text-center border">
                <h5 class="p-2 text-center">Other Details</h5>
                <div>
                    <p>Order Id : <%= order._id%>
                    </p>
                    <p>Order date : <%= moment(order.date).format("LL") %>
                    </p>
                    <p>Payment Method : <%= order.paymentMethod %>
                    </p>
                    <p>Payment Status : <%= order.paymentStatus %>
                    </p>
                </div>
                </p>
            </div>
        </div>
        <div class="row box mt-5 d-flex align-items-center ">
            <div class="text-center p-3" id="orderStatus">
                <strong>Current order status :</strong> <span class="border">
                    <%= order.orderStatus %>
                </span>
                <% if(order.orderStatus !="Cancelled" ){ %>
                    <div class=" p-2 text-center">
                        <button id="cancelBtn" class="btn btn-outline-danger m-2"
                            onclick="cancelOrder('<%= order._id %>')">Cancel
                            Order</button>
                    </div>
                    <% } %>
            </div>
        </div>
    </section>

    <script>
        let status = document.getElementById("status").value
        function cancelOrder(orderId) {
            Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, Cancel order'
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        url: '/cancelOrder/' + orderId,
                        method: 'post',
                        success: (response) => {
                            if (response) {
                                $("#orderStatus").load(" #orderStatus > *");
                                Swal.fire(
                                    'Cancelled!',
                                    'Your order has been cancelled.',
                                    'success'
                                )
                            }
                        }
                    })
                }
            })
        }

    </script>

    <%- include('../userFooter.ejs') -%>